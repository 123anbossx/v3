{"code":"import { reactive, readonly } from \"./reactive\";\nimport { isObject } from \"@vue/shared\";\nconst get = createGetter();\nconst shallowGet = createGetter(false, true);\nconst readonlyGet = createGetter(true);\nconst shallowReadonlyGet = createGetter(true, true);\nconst set = createSetter();\nconst shallowSet = createSetter(true);\nfunction createGetter(isReadonly = false, shallow = false) {\n    return function get(target, key, receiver) {\n        const res = Reflect.get(target, key, receiver);\n        if (!isReadonly) {\n            // 如果不是只读的，收集依赖\n            console.log('收集依赖');\n        }\n        if (shallow) {\n            return res;\n        }\n        // 这是一个懒代理，当用户使用这个对象的时候，才去做代理，而不是一开始就代理 （vue2 一上来就跑递归做代理）\n        if (isObject(res)) {\n            return isReadonly ? readonly(res) : reactive(res);\n        }\n        return res;\n    };\n}\nfunction createSetter(shallow = false) {\n    return function set(target, key, value, receiver) {\n        let oldValue = target[key];\n        if (!shallow) {\n            //  value = isObject(value)? reactive(value) : value\n            //  oldValue = isObject(oldValue)? reactive(oldValue) : oldValue\n        }\n        else {\n        }\n        const result = Reflect.set(target, key, value, receiver);\n        console.log('触发更新');\n        return result;\n    };\n}\nexport const mutableHandlers = {\n    get,\n    set\n};\nexport const readonlyHandlers = {\n    get: readonlyGet,\n    set(target, key, value, receiver) {\n        console.warn(`key:${key} set 失败，因为 target 是 readonly 类型`, target);\n        return true;\n    }\n};\nexport const shallowReactiveHandlers = {\n    get: shallowGet,\n    set: shallowSet\n};\nexport const shallowReadonlyHandlers = {\n    get: shallowReadonlyGet,\n    set(target, key, value, receiver) {\n        console.warn(`key:${key} set 失败，因为 target 是 readonly 类型`, target);\n        return true;\n    }\n};\n","references":["/Users/mima0000/workspace/sourceCode/vue3/vue3-test/packages/reactivity/src/reactive.ts","/Users/mima0000/workspace/sourceCode/vue3/vue3-test/packages/shared/src/index.ts"]}
